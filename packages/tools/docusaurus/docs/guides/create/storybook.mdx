---
sidebar_position: 3
---

import Admonition from 'react-admonitions';

# 3. Configure Storybook

## Overview

We use **Storybook** for a lot of different useful features it offers. For an overview, have a look at our [integrations overview for **Storybook**](../../integration/storybook/index.mdx).

## Install **Storybook**

We start by initializing **Storybook** using their CLI. We call it with `npx`, which runs the command (**Storybook**) without actually installing the dependency to our project. And as we won't be using their included examples, we just remove those immediately, too:

```bash
npx storybook init
rm -rf src/stories
```

Let's have a look at our `package.json`, after having added **Storybook**:

<CH.Spotlight>
<CH.Code>
```json package.json
{
  "name": "@my/design-system",
  "version": "1.0.0",
  "description": "Design System for all @MY needs",
  "main": "dist/index.js",
  "scripts": {
    "init-tokens": "kickstartDS tokens init",
    "build-tokens": "kickstartDS tokens compile",
    "test": "echo \"Error: no test specified\" && exit 1",
    "storybook": "start-storybook -p 6006",
    "build-storybook": "build-storybook"
  },
  "author": "Jonas Ulrich",
  "license": "MIT",
  "dependencies": {
    "@kickstartds/base": "^2.0.2",
    "kickstartds": "^1.0.0",
    "react": "^17.0.2",
    "react-dom": "^17.0.2"
  },
  "devDependencies": {
    "@babel/core": "^7.19.3",
    "@storybook/addon-actions": "^6.5.12",
    "@storybook/addon-essentials": "^6.5.12",
    "@storybook/addon-interactions": "^6.5.12",
    "@storybook/addon-links": "^6.5.12",
    "@storybook/builder-webpack4": "^6.5.12",
    "@storybook/manager-webpack4": "^6.5.12",
    "@storybook/react": "^6.5.12",
    "@storybook/testing-library": "^0.0.13",
    "babel-loader": "^8.2.5"
  }
}

````
</CH.Code>

---

### **Storybook** dependencies

Those are the dependencies added through using `npx storybook init`. They ensure **Storybook** itself can be built for development and production.

It also includes **Storybook**s Essential addon, adding recommended addons by default: https://storybook.js.org/docs/react/essentials/introduction

<CH.Code>
```json package.json focus=21:32
{
  "name": "@my/design-system",
  "version": "1.0.0",
  "description": "Design System for all @MY needs",
  "main": "dist/index.js",
  "scripts": {
    "init-tokens": "kickstartDS tokens init",
    "build-tokens": "kickstartDS tokens compile",
    "test": "echo \"Error: no test specified\" && exit 1",
    "storybook": "start-storybook -p 6006",
    "build-storybook": "build-storybook"
  },
  "author": "Jonas Ulrich",
  "license": "MIT",
  "dependencies": {
    "@kickstartds/base": "^2.0.2",
    "kickstartds": "^1.0.0",
    "react": "^17.0.2",
    "react-dom": "^17.0.2"
  },
  "devDependencies": {
    "@babel/core": "^7.19.3",
    "@storybook/addon-actions": "^6.5.12",
    "@storybook/addon-essentials": "^6.5.12",
    "@storybook/addon-interactions": "^6.5.12",
    "@storybook/addon-links": "^6.5.12",
    "@storybook/builder-webpack4": "^6.5.12",
    "@storybook/manager-webpack4": "^6.5.12",
    "@storybook/react": "^6.5.12",
    "@storybook/testing-library": "^0.0.13",
    "babel-loader": "^8.2.5"
  }
}
````

</CH.Code>

---

### New `scripts` entries

Next to the dependencies, two `scripts` entries were added by the **Storybook** init:

1. **Storybook**: to start your **Storybook** in development / watch mode
2. `build-storybook`: to build a production ready, deployable version of your **Storybook**

<CH.Code>
```json package.json focus=10:11
{
  "name": "@my/design-system",
  "version": "1.0.0",
  "description": "Design System for all @MY needs",
  "main": "dist/index.js",
  "scripts": {
    "init-tokens": "kickstartDS tokens init",
    "build-tokens": "kickstartDS tokens compile",
    "test": "echo \"Error: no test specified\" && exit 1",
    "storybook": "start-storybook -p 6006",
    "build-storybook": "build-storybook"
  },
  "author": "Jonas Ulrich",
  "license": "MIT",
  "dependencies": {
    "@kickstartds/base": "^2.0.2",
    "kickstartds": "^1.0.0",
    "react": "^17.0.2",
    "react-dom": "^17.0.2"
  },
  "devDependencies": {
    "@babel/core": "^7.19.3",
    "@storybook/addon-actions": "^6.5.12",
    "@storybook/addon-essentials": "^6.5.12",
    "@storybook/addon-interactions": "^6.5.12",
    "@storybook/addon-links": "^6.5.12",
    "@storybook/builder-webpack4": "^6.5.12",
    "@storybook/manager-webpack4": "^6.5.12",
    "@storybook/react": "^6.5.12",
    "@storybook/testing-library": "^0.0.13",
    "babel-loader": "^8.2.5"
  }
}

````

</CH.Code>
</CH.Spotlight>

Add the following lines to your `.gitignore` to exclude locally built versions of **Storybook** (e.g. by calling `yarn build-storybook`):

```bash .gitignore focus=4:5
# Node
node_modules

# Storybook
storybook-static

# kickstartDS
src/token/tokens.css
```


## Configure **Storybook**

Now that we have installed **Storybook**, it's time to add some general configuration. We'll also add a first *Welcome* page to test everything configured so far actually works.

### General configuration

For this we'll be looking at the `.storybook` folder, automatically created for us by `npx storybook init`. It contains all general configuration to make a **Storybook** your own, and allows to really adapt it to your use case. We'll set up some integrations that are convenient to use, especially when working with **kickstartDS**.

The folder contains two files for now:
* `.storybook/main.js`
* `.storybook/preview.js`

#### `main.js` configuration

This file contains configuration for **Storybook** itself... which addons to load, additional addon configuration, Webpack build & compile configuration, and so on. We'll continue building this up while adding addons in the next steps.

For a detailed overview, have a look at [**Storybook**s documentation](https://storybook.js.org/docs/react/configure/overview).

<CH.Scrollycoding>

##### After `npx storybook init`

Right after running **Storybook**s initialization, you should find it looking like this.

<CH.Code>
```js .storybook/main.js
module.exports = {
  "stories": [
    "../src/**/*.stories.mdx",
    "../src/**/*.stories.@(js|jsx|ts|tsx)"
  ],
  "addons": [
    "@storybook/addon-links",
    "@storybook/addon-essentials",
    "@storybook/addon-interactions",
  ],
  "framework": "@storybook/react",
}
```
</CH.Code>

---

##### Remove quotes

We remove some quotes from `main.js`, because we're in a `.js` file.

<CH.Code>
```js .storybook/main.js focus=2,6,11
module.exports = {
  stories: [
    "../src/**/*.stories.mdx",
    "../src/**/*.stories.@(js|jsx|ts|tsx)"
  ],
  addons: [
    "@storybook/addon-links",
    "@storybook/addon-essentials",
    "@storybook/addon-interactions",
  ],
  framework: "@storybook/react",
}
```
</CH.Code>

---

##### Deactivate implicit Post CSS loader

As we don't need it, we deactivate the implicit Post CSS loader as recommended.

You can read more about this [here](https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#deprecated-implicit-postcss-loader).

<CH.Code>
```js .storybook/main.js focus=12:14
module.exports = {
  stories: [
    "../src/**/*.stories.mdx",
    "../src/**/*.stories.@(js|jsx|ts|tsx)"
  ],
  addons: [
    "@storybook/addon-links",
    "@storybook/addon-essentials",
    "@storybook/addon-interactions",
  ],
  framework: "@storybook/react",
  features: {
    postcss: false,
  },
}
```
</CH.Code>

---

##### Add glob for documentation

We'll be adding a few pages of documentation to test configuration, but these can also serve as the perfect starting point and orientation for your own growing documentation. For **Storybook** to pick up those pages, we have to tell it where those will be found. We'll be creating that folder `docs/` later.

<CH.Code>
```js .storybook/main.js focus=5
module.exports = {
  stories: [
    "../src/**/*.stories.mdx",
    "../src/**/*.stories.@(js|jsx|ts|tsx)",
    "../docs/**/*.stories.mdx",
  ],
  addons: [
    "@storybook/addon-links",
    "@storybook/addon-essentials",
    "@storybook/addon-interactions",
  ],
  framework: "@storybook/react",
  features: {
    postcss: false,
  },
}
```
</CH.Code>
</CH.Scrollycoding>

#### `preview.js` configuration

This file specifically includes configuration for component **previews**, we'll need to make sure all needed CSS is loaded here... for example! Additionally, configuration for how stories are displayed can be adjusted globally, through the exports `parameters` and `decorators` (amongst others, learn more [here](https://storybook.js.org/docs/react/configure/overview#configure-story-rendering)).

<CH.Scrollycoding>

##### After `npx storybook init`

We'll start off again with the file as created by **Storybook**s initialization.

<CH.Code>
```js .storybook/preview.js
export const parameters = {
  actions: { argTypesRegex: "^on[A-Z].*" },
  controls: {
    matchers: {
      color: /(background|color)$/i,
      date: /Date$/,
    },
  },
}
```
</CH.Code>

---

##### Add story sorting

Adding a `storySort` function to the `options` allows us to ensure the *Welcome* page will always be displayed first. Everything else should be sorted alphabetically. Learn more [about `storySort`](https://storybook.js.org/docs/react/writing-stories/naming-components-and-hierarchy#sorting-stories).

<CH.Code>
```js .storybook/preview.js focus=9:21
export const parameters = {
  actions: { argTypesRegex: "^on[A-Z].*" },
  controls: {
    matchers: {
      color: /(background|color)$/i,
      date: /Date$/,
    },
  },
  options: {
    storySort(a, b) {
      // welcome page to top!
      if (a[0].includes("welcome")) {
        return -1;
      }

      // alphabetically
      return a[1].kind === b[1].kind
        ? 0
        : a[1].id.localeCompare(b[1].id, undefined, { numeric: true });
    },
  },
}
```
</CH.Code>
</CH.Scrollycoding>

#### Adding a *Welcome* page

As promised we add a *Welcome* page now, to verify configuration... and to have something in **Storybook** to display in the browser.

Create a folder `docs` at the root of your repository, and add a file `welcome.stories.mdx` to it. `.mdx` is an extension of the popular [Markdown](https://daringfireball.net/projects/markdown/) format, allowing the use of `React` / `JSX` components as part of your documentation. In the context of **kickstartDS** this also means being able to use all of your components as part of your **Storybook** documentation, too. For example having nice hero images on pages important to you!

Learn more about the `.mdx` format [here](https://mdxjs.com/).

```bash
mkdir -p docs
touch docs/welcome.stories.mdx
```

Add the following content to it:

<CH.Spotlight>
<CH.Code>
```mdx docs/welcome.stories.mdx
import { Meta } from "@storybook/addon-docs";

<Meta title="Welcome" />

# Your kickstartDS based Design System

Ipsum voluptate reprehenderit ut aliquid laborum enim. Optio et suscipit aliquam voluptate nostrum est. Corrupti ab laboriosam qui aut aliquid iusto nobis voluptatum. Perferendis non reiciendis illum. Vel et sint est.

Alias placeat accusantium voluptatem pariatur dolor et. Dicta quia officia voluptatem quia nulla natus. Accusantium in voluptate porro. Libero voluptatem placeat ipsum dolores deserunt omnis odio.

Sed distinctio consequuntur et et aliquid. Exercitationem autem impedit expedita. Beatae eum voluptatem eaque necessitatibus repellendus. Velit qui est optio. Ut est voluptates incidunt et qui sed dolorem. Quidem molestiae velit non laudantium consequatur autem.

Amet doloremque voluptas suscipit. Omnis incidunt sit nesciunt voluptate sed voluptatem delectus quis. Repudiandae occaecati magni fugit. Minus sunt quia ab temporibus. Voluptatibus vel odit facere enim et.

Consequatur et consequuntur et. Nam consequatur sed voluptas ea. Tempore vero velit et hic. Ut et aspernatur quaerat ut aut consequatur. Quisquam aliquid ea adipisci nulla quia ut dolor. Accusamus earum quasi quaerat.
```
</CH.Code>

---

##### Define story title and category

We define a title and category for our *Welcome* page by importing and using `Meta` from `@storybook/addon-docs`, a component provided to us by **Storybook**.

This would also be a first example on the benefits of using `.mdx` for documentation.

<CH.Code>
```mdx docs/welcome.stories.mdx focus=1,3
import { Meta } from "@storybook/addon-docs";

<Meta title="Welcome" />

# Your kickstartDS based Design System

Ipsum voluptate reprehenderit ut aliquid laborum enim. Optio et suscipit aliquam voluptate nostrum est. Corrupti ab laboriosam qui aut aliquid iusto nobis voluptatum. Perferendis non reiciendis illum. Vel et sint est.

Alias placeat accusantium voluptatem pariatur dolor et. Dicta quia officia voluptatem quia nulla natus. Accusantium in voluptate porro. Libero voluptatem placeat ipsum dolores deserunt omnis odio.

Sed distinctio consequuntur et et aliquid. Exercitationem autem impedit expedita. Beatae eum voluptatem eaque necessitatibus repellendus. Velit qui est optio. Ut est voluptates incidunt et qui sed dolorem. Quidem molestiae velit non laudantium consequatur autem.

Amet doloremque voluptas suscipit. Omnis incidunt sit nesciunt voluptate sed voluptatem delectus quis. Repudiandae occaecati magni fugit. Minus sunt quia ab temporibus. Voluptatibus vel odit facere enim et.

Consequatur et consequuntur et. Nam consequatur sed voluptas ea. Tempore vero velit et hic. Ut et aspernatur quaerat ut aut consequatur. Quisquam aliquid ea adipisci nulla quia ut dolor. Accusamus earum quasi quaerat.
```
</CH.Code>

---

##### Some initial dummy content

The rest of the file just contains some dummy content to start. Feel free to replace this with something more meaningful, but you'll probably want to revisit this page later, anyways!

<CH.Code>
```mdx docs/welcome.stories.mdx focus=5:15
import { Meta } from "@storybook/addon-docs";

<Meta title="Welcome" />

# Your kickstartDS based Design System

Ipsum voluptate reprehenderit ut aliquid laborum enim. Optio et suscipit aliquam voluptate nostrum est. Corrupti ab laboriosam qui aut aliquid iusto nobis voluptatum. Perferendis non reiciendis illum. Vel et sint est.

Alias placeat accusantium voluptatem pariatur dolor et. Dicta quia officia voluptatem quia nulla natus. Accusantium in voluptate porro. Libero voluptatem placeat ipsum dolores deserunt omnis odio.

Sed distinctio consequuntur et et aliquid. Exercitationem autem impedit expedita. Beatae eum voluptatem eaque necessitatibus repellendus. Velit qui est optio. Ut est voluptates incidunt et qui sed dolorem. Quidem molestiae velit non laudantium consequatur autem.

Amet doloremque voluptas suscipit. Omnis incidunt sit nesciunt voluptate sed voluptatem delectus quis. Repudiandae occaecati magni fugit. Minus sunt quia ab temporibus. Voluptatibus vel odit facere enim et.

Consequatur et consequuntur et. Nam consequatur sed voluptas ea. Tempore vero velit et hic. Ut et aspernatur quaerat ut aut consequatur. Quisquam aliquid ea adipisci nulla quia ut dolor. Accusamus earum quasi quaerat.
```
</CH.Code>

</CH.Spotlight>

#### Verifying configuration

It's not much, yet, but we can start our **Storybook** now to see our *Welcome* page in action:

```bash
yarn storybook
```

This should automatically open **Storybook** in your browser of choice. Next to displaying your first page (ðŸ™Œ), there's something interesting that happened!

As part of the left sidebar, and under your initially opened *Welcome* page, there'll be a section titled `@kickstartds/base`. This gets shown because we've added `@kickstartds/base` as a dependency before. **kickstartDS** uses [Storybook composition](https://storybook.js.org/docs/react/sharing/storybook-composition) to always include the base documentation (in the correct version used by your Design System) to your **Storybook**, as a handy reference!

### **Design Token** integration

Next up is adding some glue code to have our **Design Token** set nicely integrated with **Storybook**. We can start by copying some stories provided by **kickstartDS** (those are the same that can be seen [here](https://www.kickstartds.com/storybook/?path=/story/design-tokens-colors--page)).

#### Add `storybook-design-token` addon

For **Design Token** documentation we also use [`storybook-design-token`](https://storybook.js.org/addons/storybook-design-token/) as an addon. Mainly for its `DesignTokenDocBlock` component, which helps in rendering the pages we've copied. So we also install that, too:

```bash
cp -r node_modules/@kickstartds/core/lib/design-tokens docs/tokens
yarn add -D storybook-design-token
```

But if you start your **Storybook** now (`yarn storybook`), you'll be greeted by empty pages. That's because we've not set up the actual **Design Token** integration with **Storybook** / our **Style Dictionary**, yet.

#### Integrate with **Style Dictionary**

As the `storybook-design-token` addon needs our tokens in a specific format (read more [here](https://github.com/UX-and-I/storybook-design-token#available-presenters)), we adjust our **Style Dictionary** configuration in `sd.config.cjs` to include the provided **Storybook** configuration. We also tell it to put those **Storybook** specific files into our already existing `src/token` directory:

```js sd.config.cjs focus=14:16
const path = require('path');
const StyleDictionary = require("style-dictionary");
const { config } = require("@kickstartds/style-dictionary");

module.exports = StyleDictionary.extend(config).extend({
  source: [
    "src/token/dictionary/**/*.json",
    path.join(path.dirname(require.resolve('@kickstartds/core/package.json')), 'source/design-tokens/icons/*.svg')
  ],
  platforms: {
    css: {
      buildPath: 'src/token/'
    },
    storybook: {
      buildPath: 'src/token/storybook/'
    },
  },
});
```

With that change, re-build your **Design Token** set:

```bash
yarn build-tokens
```

You'll notice it now writes two additional files for you, specifically for the **Storybook** integration:

<CH.Spotlight>

<CH.Code>
```shellscript focus=37:39
yarn run v1.22.18
$ kickstartDS tokens compile
  _    _      _        _             _   ____  ____
 | | _(_) ___| | _____| |_ __ _ _ __| |_|  _ \/ ___|
 | |/ / |/ __| |/ / __| __/ _` | '__| __| | | \___ \
 |   <| | (__|   <\__ \ || (_| | |  | |_| |_| |___) |
 |_|\_\_|\___|_|\_\___/\__\__,_|_|   \__|____/|____/

______________/\\\\\\\\\__/\\\______________/\\\\\\\\\\\_______
 ___________/\\\////////__\/\\\_____________\/////\\\///________
  _________/\\\/___________\/\\\_________________\/\\\___________
   ________/\\\_____________\/\\\_________________\/\\\___________
    _______\/\\\_____________\/\\\_________________\/\\\___________
     _______\//\\\____________\/\\\_________________\/\\\___________
      ________\///\\\__________\/\\\_________________\/\\\___________
       __/\\\____\////\\\\\\\\\_\/\\\\\\\\\\\\\\\__/\\\\\\\\\\\__/\\\_
        _\///________\/////////__\///////////////__\///////////__\///__

Version: 1.0.0
For more information visit:
https://www.kickstartDS.com/docs/intro/cli

Starting...
[kickstartDS: general] [info]: welcome to the kickstartDS CLI
[kickstartDS: tokens/compile] starting: compile command with compile variable compile-task
[1/1] [compile: check] [info]: checking prerequesites before starting
[1/1] [compile: check] [info]: prerequesites met, starting
[compile: cleanup] [info]: cleaning up temp dir /tmp/tokens-compile-compile-task before starting command
[compile: cleanup] [info]: finished cleaning up temp dir /tmp/tokens-compile-compile-task before starting command
[1/1] [compile: compile] [info]: running the compile subtask
[1/1] [compile: compile] [info]: getting Style Dictionary from token files
[1/1] [compile: compile] [info]: compiling Style Dictionary to needed CSS and assets

css
âœ”ï¸Ž src/token/tokens.css

storybook
âœ”ï¸Ž src/token/storybook/tokens.css
âœ”ï¸Ž src/token/storybook/icons.svg
[1/1] [compile: compile] [info]: copying generated CSS and assets to local folder
[1/1] [compile: compile] [info]: finished running the compile subtask successfully
[kickstartDS: tokens/compile] finished: compile command with compile variable compile-task
Done in 1.08s.
```
</CH.Code>

---

##### Annotated `tokens.css`

Those are all of our **Design Token** converted to [CSS custom properties](https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties) (as with `src/token/tokens.css`), but with the correct `storybook-design-token` presenters already added.

<CH.Code>
```shellscript focus=38
yarn run v1.22.18
$ kickstartDS tokens compile
  _    _      _        _             _   ____  ____
 | | _(_) ___| | _____| |_ __ _ _ __| |_|  _ \/ ___|
 | |/ / |/ __| |/ / __| __/ _` | '__| __| | | \___ \
 |   <| | (__|   <\__ \ || (_| | |  | |_| |_| |___) |
 |_|\_\_|\___|_|\_\___/\__\__,_|_|   \__|____/|____/

______________/\\\\\\\\\__/\\\______________/\\\\\\\\\\\_______
 ___________/\\\////////__\/\\\_____________\/////\\\///________
  _________/\\\/___________\/\\\_________________\/\\\___________
   ________/\\\_____________\/\\\_________________\/\\\___________
    _______\/\\\_____________\/\\\_________________\/\\\___________
     _______\//\\\____________\/\\\_________________\/\\\___________
      ________\///\\\__________\/\\\_________________\/\\\___________
       __/\\\____\////\\\\\\\\\_\/\\\\\\\\\\\\\\\__/\\\\\\\\\\\__/\\\_
        _\///________\/////////__\///////////////__\///////////__\///__

Version: 1.0.0
For more information visit:
https://www.kickstartDS.com/docs/intro/cli

Starting...
[kickstartDS: general] [info]: welcome to the kickstartDS CLI
[kickstartDS: tokens/compile] starting: compile command with compile variable compile-task
[1/1] [compile: check] [info]: checking prerequesites before starting
[1/1] [compile: check] [info]: prerequesites met, starting
[compile: cleanup] [info]: cleaning up temp dir /tmp/tokens-compile-compile-task before starting command
[compile: cleanup] [info]: finished cleaning up temp dir /tmp/tokens-compile-compile-task before starting command
[1/1] [compile: compile] [info]: running the compile subtask
[1/1] [compile: compile] [info]: getting Style Dictionary from token files
[1/1] [compile: compile] [info]: compiling Style Dictionary to needed CSS and assets

css
âœ”ï¸Ž src/token/tokens.css

storybook
âœ”ï¸Ž src/token/storybook/tokens.css
âœ”ï¸Ž src/token/storybook/icons.svg
[1/1] [compile: compile] [info]: copying generated CSS and assets to local folder
[1/1] [compile: compile] [info]: finished running the compile subtask successfully
[kickstartDS: tokens/compile] finished: compile command with compile variable compile-task
Done in 1.08s.
```
</CH.Code>

---

##### `icons.svg` icon collection

Contains a collection of all used icons. Similarly to before, they just get annotated with the correct presenters for `storybook-design-token` for **Storybook**.<br/>
The file gets picked up by the addon automatically, we don't need to add any additional configuration.

<CH.Code>
```shellscript focus=39
yarn run v1.22.18
$ kickstartDS tokens compile
  _    _      _        _             _   ____  ____
 | | _(_) ___| | _____| |_ __ _ _ __| |_|  _ \/ ___|
 | |/ / |/ __| |/ / __| __/ _` | '__| __| | | \___ \
 |   <| | (__|   <\__ \ || (_| | |  | |_| |_| |___) |
 |_|\_\_|\___|_|\_\___/\__\__,_|_|   \__|____/|____/

______________/\\\\\\\\\__/\\\______________/\\\\\\\\\\\_______
 ___________/\\\////////__\/\\\_____________\/////\\\///________
  _________/\\\/___________\/\\\_________________\/\\\___________
   ________/\\\_____________\/\\\_________________\/\\\___________
    _______\/\\\_____________\/\\\_________________\/\\\___________
     _______\//\\\____________\/\\\_________________\/\\\___________
      ________\///\\\__________\/\\\_________________\/\\\___________
       __/\\\____\////\\\\\\\\\_\/\\\\\\\\\\\\\\\__/\\\\\\\\\\\__/\\\_
        _\///________\/////////__\///////////////__\///////////__\///__

Version: 1.0.0
For more information visit:
https://www.kickstartDS.com/docs/intro/cli

Starting...
[kickstartDS: general] [info]: welcome to the kickstartDS CLI
[kickstartDS: tokens/compile] starting: compile command with compile variable compile-task
[1/1] [compile: check] [info]: checking prerequesites before starting
[1/1] [compile: check] [info]: prerequesites met, starting
[compile: cleanup] [info]: cleaning up temp dir /tmp/tokens-compile-compile-task before starting command
[compile: cleanup] [info]: finished cleaning up temp dir /tmp/tokens-compile-compile-task before starting command
[1/1] [compile: compile] [info]: running the compile subtask
[1/1] [compile: compile] [info]: getting Style Dictionary from token files
[1/1] [compile: compile] [info]: compiling Style Dictionary to needed CSS and assets

css
âœ”ï¸Ž src/token/tokens.css

storybook
âœ”ï¸Ž src/token/storybook/tokens.css
âœ”ï¸Ž src/token/storybook/icons.svg
[1/1] [compile: compile] [info]: copying generated CSS and assets to local folder
[1/1] [compile: compile] [info]: finished running the compile subtask successfully
[kickstartDS: tokens/compile] finished: compile command with compile variable compile-task
Done in 1.08s.
```
</CH.Code>

</CH.Spotlight>

#### Integrate with **Storybook** manager

The final piece of the puzzle to get our **Design Token** docs working is to actually load our prepared `src/token/storybook/tokens.css` file. As this is specific to **Storybook** (we'll use the untouched, converted CSS custom properties of `src/token/tokens.css` for `preview.js`), this will be done in a new file `.storybook/manager.scss`. We use `Sass` here, as it will be featured later in this guide for component customization, too.

Here it helps re-using the file in `src/token`, while also adding some **CSS**.

Create the file:

```bash
touch .storybook/manager.scss
```

<CH.Section>
And add the following content to it:

<CH.Code>
```scss .storybook/manager.scss
@use '../src/token/storybook/tokens.css';

.sidebar-item {
  svg {
    color: inherit;
  }
}

```
</CH.Code>

We pull in our generated tokens with [`@use`](focus://1), and add [some CSS](focus://3:7) to ensure the icon colors actually get inherited.
</CH.Section>

Now that we've added a `.scss` file, we'll need to also add `Sass` compilation capabilities to our project. Install `sass` and add the following lines to your `package.json`:

```bash
yarn add -D sass
```

<CH.Scrollycoding>

##### After adding `sass`

A single entry in `devDependencies` should've been added.

<CH.Code>
```json package.json focus=32
{
  "name": "@my/design-system",
  "version": "1.0.0",
  "description": "Design System for all @MY needs",
  "main": "dist/index.js",
  "scripts": {
    "init-tokens": "kickstartDS tokens init",
    "build-tokens": "kickstartDS tokens compile",
    "test": "echo \"Error: no test specified\" && exit 1",
    "storybook": "start-storybook -p 6006",
    "build-storybook": "build-storybook"
  },
  "author": "Jonas Ulrich",
  "license": "MIT",
  "dependencies": {
    "@kickstartds/base": "^2.0.2",
    "kickstartds": "^1.0.0",
    "react": "^17.0.2",
    "react-dom": "^17.0.2"
  },
  "devDependencies": {
    "@babel/core": "^7.19.3",
    "@storybook/addon-actions": "^6.5.12",
    "@storybook/addon-essentials": "^6.5.12",
    "@storybook/addon-interactions": "^6.5.12",
    "@storybook/addon-links": "^6.5.12",
    "@storybook/builder-webpack4": "^6.5.12",
    "@storybook/manager-webpack4": "^6.5.12",
    "@storybook/react": "^6.5.12",
    "@storybook/testing-library": "^0.0.13",
    "babel-loader": "^8.2.5",
    "sass": "^1.56.0",
    "storybook-design-token": "^2.8.0"
  }
}
```
</CH.Code>

---

##### Re-order `scripts` entries

To keep some order in our `scripts` entries, we re-order them to be sorted alphabetically before adding some more.

<Admonition type="tip" title="Trailing commas">
  It's easy to mix up some trailing commas here!
</Admonition>

<CH.Code>
```json package.json
{
  "name": "@my/design-system",
  "version": "1.0.0",
  "description": "Design System for all @MY needs",
  "main": "dist/index.js",
  "scripts": {
    "build-storybook": "build-storybook",
    "build-tokens": "kickstartDS tokens compile",
    "init-tokens": "kickstartDS tokens init",
    "storybook": "start-storybook -p 6006",
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "Jonas Ulrich",
  "license": "MIT",
  "dependencies": {
    "@kickstartds/base": "^2.0.2",
    "kickstartds": "^1.0.0",
    "react": "^17.0.2",
    "react-dom": "^17.0.2"
  },
  "devDependencies": {
    "@babel/core": "^7.19.3",
    "@storybook/addon-actions": "^6.5.12",
    "@storybook/addon-essentials": "^6.5.12",
    "@storybook/addon-interactions": "^6.5.12",
    "@storybook/addon-links": "^6.5.12",
    "@storybook/builder-webpack4": "^6.5.12",
    "@storybook/manager-webpack4": "^6.5.12",
    "@storybook/react": "^6.5.12",
    "@storybook/testing-library": "^0.0.13",
    "babel-loader": "^8.2.5",
    "sass": "^1.56.0",
    "storybook-design-token": "^2.8.0"
  }
}
```
</CH.Code>

---

##### Compile `.storybook/manager.scss`

We add a script entry called `sass-manager`, which when called will compile our `Sass` to a regular **CSS** file (placed in `static/manager.css`) to be read by **Storybook**.

<CH.Code>
```json package.json focus=10
{
  "name": "@my/design-system",
  "version": "1.0.0",
  "description": "Design System for all @MY needs",
  "main": "dist/index.js",
  "scripts": {
    "build-storybook": "build-storybook",
    "build-tokens": "kickstartDS tokens compile",
    "init-tokens": "kickstartDS tokens init",
    "sass-manager": "sass --load-path=node_modules .storybook/manager.scss static/manager.css",
    "storybook": "start-storybook -p 6006",
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "Jonas Ulrich",
  "license": "MIT",
  "dependencies": {
    "@kickstartds/base": "^2.0.2",
    "kickstartds": "^1.0.0",
    "react": "^17.0.2",
    "react-dom": "^17.0.2"
  },
  "devDependencies": {
    "@babel/core": "^7.19.3",
    "@storybook/addon-actions": "^6.5.12",
    "@storybook/addon-essentials": "^6.5.12",
    "@storybook/addon-interactions": "^6.5.12",
    "@storybook/addon-links": "^6.5.12",
    "@storybook/builder-webpack4": "^6.5.12",
    "@storybook/manager-webpack4": "^6.5.12",
    "@storybook/react": "^6.5.12",
    "@storybook/testing-library": "^0.0.13",
    "babel-loader": "^8.2.5",
    "sass": "^1.56.0",
    "storybook-design-token": "^2.8.0"
  }
}
```
</CH.Code>

---

##### Watch mode for `.storybook/manager.scss`

And while we're at it, we'll also add a watch task that can be used in development. This rebuilds your changes to `manager.scss` live, and triggers a reload in your browser subsequently.

<CH.Code>
```json package.json focus=13
{
  "name": "@my/design-system",
  "version": "1.0.0",
  "description": "Design System for all @MY needs",
  "main": "dist/index.js",
  "scripts": {
    "build-storybook": "build-storybook",
    "build-tokens": "kickstartDS tokens compile",
    "init-tokens": "kickstartDS tokens init",
    "sass-manager": "sass --load-path=node_modules .storybook/manager.scss static/manager.css",
    "storybook": "start-storybook -p 6006",
    "test": "echo \"Error: no test specified\" && exit 1",
    "watch:sass-manager": "yarn sass-manager --watch"
  },
  "author": "Jonas Ulrich",
  "license": "MIT",
  "dependencies": {
    "@kickstartds/base": "^2.0.2",
    "kickstartds": "^1.0.0",
    "react": "^17.0.2",
    "react-dom": "^17.0.2"
  },
  "devDependencies": {
    "@babel/core": "^7.19.3",
    "@storybook/addon-actions": "^6.5.12",
    "@storybook/addon-essentials": "^6.5.12",
    "@storybook/addon-interactions": "^6.5.12",
    "@storybook/addon-links": "^6.5.12",
    "@storybook/builder-webpack4": "^6.5.12",
    "@storybook/manager-webpack4": "^6.5.12",
    "@storybook/react": "^6.5.12",
    "@storybook/testing-library": "^0.0.13",
    "babel-loader": "^8.2.5",
    "sass": "^1.56.0",
    "storybook-design-token": "^2.8.0"
  }
}
```
</CH.Code>

</CH.Scrollycoding>

The correct place to put such **CSS** specific to **Storybook**s UI is `.storybook/manager-head.html` (you can read more about their [`CSS escape hatches` here](https://storybook.js.org/docs/react/configure/theming#css-escape-hatches)). We'll create that file, too:

```bash
touch .storybook/manager-head.html
```

And add the following content to it:

```html .storybook/manager-head.html
<link rel="stylesheet" href="manager.css" />
```

#### Finalizing **Design Token** integration steps

<CH.Section>
To get **Storybook** to pick up our `static` folder when run / compiled, and thus above relative reference to work, we also [need to tell **Storybook** about it](focus://17) in `.storybook/main.js`. Further we have to [add the `storybook-design-token` addon](focus://11:14) to the `addons` array. [The `designTokenGlob`](focus://13[18:57]) tells it where to find our token definitions (the annotated `token.css` from before):

```js .storybook/main.js
module.exports = {
  stories: [
    "../src/**/*.stories.mdx",
    "../src/**/*.stories.@(js|jsx|ts|tsx)",
    "../docs/**/*.stories.mdx",
  ],
  addons: [
    "@storybook/addon-links",
    "@storybook/addon-essentials",
    "@storybook/addon-interactions",
    {
      name: "storybook-design-token",
      options: { designTokenGlob: "src/token/storybook/*" },
    },
  ],
  framework: "@storybook/react",
  staticDirs: ["../static"],
  features: {
    postcss: false,
  },
}
```
</CH.Section>

Finally, we'll disable the `storybook-design-token` addon in Canvas views. It's output there is redundant when having explicit pages for **Design Token**, and tends to be a bit noisy in the context of a singular component, anyway. Learn more about that option (and other ones) [in the official addon documentation](https://github.com/UX-and-I/storybook-design-token#disable-the-addon-panel).

As this is an option concerned with the general rendering of a Story, the change will have to be made in `.storybook/preview.js`:

```js .storybook/preview.js focus=22:24
export const parameters = {
  actions: { argTypesRegex: "^on[A-Z].*" },
  controls: {
    matchers: {
      color: /(background|color)$/i,
      date: /Date$/,
    },
  },
  options: {
    storySort(a, b) {
      // welcome page to top!
      if (a[0].includes("welcome")) {
        return -1;
      }

      // alphabetically
      return a[1].kind === b[1].kind
        ? 0
        : a[1].id.localeCompare(b[1].id, undefined, { numeric: true });
    },
  },
  designToken: {
    disable: true,
  },
}
```

If you re-start, or re-open, your **Storybook** now (`yarn storybook`), you'll be greeted by all your glorious **Design Token**. Neatly categorized by category and semantic meaning!

<Admonition type="tip" title="Empty tables in Firefox?">
  This was a bug with the `storybook-design-token` addon, [see this issue](https://github.com/UX-and-I/storybook-design-token/issues/129).

  This is fixed starting with version `2.8.0` of the addon. If you're affected, just update your version to `^2.8.0` or higher in your `package.json`, to fix the addon!
</Admonition>

We'll add those additional files generated based on our **Design Token** set to our `.gitignore` now:

```bash .gitignore focus=7,9:11
# Node
node_modules

# Storybook
storybook-static

# kickstartDS
src/token/tokens.css
src/token/storybook/tokens.css
src/token/storybook/icons.svg
static/manager.css
```

### Add **Storybook** theming

We have a **Design Token** set, we have a **Storybook**... what better idea than to combine those two! Re-using our existing token to add some (reserved) theming to our general **Storybook** UI also serves as a great first, albeit small, demonstration for how useful a well constructed **Design Token** set can be!

Creating a **Storybook** theme involves creating two files, and adding a new output format (`.js`) to our **Style Dictionary**:

* `.storybook/manager.js`: used to import and set our custom theme
* `.storybook/themes.js`: definition of our custom theme, using the new output format

Learn more [about theming in **Storybook**](https://storybook.js.org/docs/react/configure/theming).

#### Adding a **Style Dictionary** transform

We start off by adding the new **Style Dictionary** transform in `sd.config.cjs`:

<CH.Section>
<CH.Code>
```js sd.config.cjs focus=17:26
const path = require('path');
const StyleDictionary = require("style-dictionary");
const { config } = require("@kickstartds/style-dictionary");

module.exports = StyleDictionary.extend(config).extend({
  source: [
    "src/token/dictionary/**/*.json",
    path.join(path.dirname(require.resolve('@kickstartds/core/package.json')), 'source/design-tokens/icons/*.svg')
  ],
  platforms: {
    css: {
      buildPath: 'src/token/'
    },
    storybook: {
      buildPath: 'src/token/storybook/'
    },
    js: {
      transforms: ["attribute/cti", "name/cti/pascal", "size/rem", "color/css"],
      buildPath: "src/token/storybook/",
      files: [
        {
          destination: "tokens.js",
          format: "javascript/es6",
        },
      ],
    },
  },
});

```
</CH.Code>

[The `transforms`](focus://18) ensure a naming format that we'll use in our `.storybook/themes.js`, up next. We also instruct our new transform to put the generate **JavaScript** file [into our **Storybook** specific token folder](focus://19) `src/token/storybook` [as `tokens.js`](focus://22). We opt for **JavaScript** so an easy import from inside `.storybook/themes.js` is possible. This is also the reason for selecting [`javascript/es6` as the `format`](focus://20:25).
</CH.Section>

With that new transform in place, re-build your **Design Token** set again:

```bash
yarn build-tokens
```

You'll be greeted by a new file being created at `src/token/storybook/tokens.js`:

```shellscript focus=41:42
yarn run v1.22.18
$ kickstartDS tokens compile
  _    _      _        _             _   ____  ____
 | | _(_) ___| | _____| |_ __ _ _ __| |_|  _ \/ ___|
 | |/ / |/ __| |/ / __| __/ _` | '__| __| | | \___ \
 |   <| | (__|   <\__ \ || (_| | |  | |_| |_| |___) |
 |_|\_\_|\___|_|\_\___/\__\__,_|_|   \__|____/|____/

______________/\\\\\\\\\__/\\\______________/\\\\\\\\\\\_______
 ___________/\\\////////__\/\\\_____________\/////\\\///________
  _________/\\\/___________\/\\\_________________\/\\\___________
   ________/\\\_____________\/\\\_________________\/\\\___________
    _______\/\\\_____________\/\\\_________________\/\\\___________
     _______\//\\\____________\/\\\_________________\/\\\___________
      ________\///\\\__________\/\\\_________________\/\\\___________
       __/\\\____\////\\\\\\\\\_\/\\\\\\\\\\\\\\\__/\\\\\\\\\\\__/\\\_
        _\///________\/////////__\///////////////__\///////////__\///__

Version: 1.0.0
For more information visit:
https://www.kickstartDS.com/docs/intro/cli

Starting...
[kickstartDS: general] [info]: welcome to the kickstartDS CLI
[kickstartDS: tokens/compile] starting: compile command with compile variable compile-task
[1/1] [compile: check] [info]: checking prerequesites before starting
[1/1] [compile: check] [info]: prerequesites met, starting
[compile: cleanup] [info]: cleaning up temp dir /tmp/tokens-compile-compile-task before starting command
[compile: cleanup] [info]: finished cleaning up temp dir /tmp/tokens-compile-compile-task before starting command
[1/1] [compile: compile] [info]: running the compile subtask
[1/1] [compile: compile] [info]: getting Style Dictionary from token files
[1/1] [compile: compile] [info]: compiling Style Dictionary to needed CSS and assets

css
âœ”ï¸Ž src/token/tokens.css

storybook
âœ”ï¸Ž src/token/storybook/tokens.css
âœ”ï¸Ž src/token/storybook/icons.svg

js
âœ”ï¸Ž src/token/storybook/tokens.js
[1/1] [compile: compile] [info]: copying generated CSS and assets to local folder
[1/1] [compile: compile] [info]: finished running the compile subtask successfully
[kickstartDS: tokens/compile] finished: compile command with compile variable compile-task
Done in 1.17s.
```

#### Adding `.storybook/themes.js`

Create the file `.storybook/themes.js`...

```bash
touch .storybook/themes.js
```

... and add the following content:

<CH.Section>
<CH.Code>
```js .storybook/themes.js
import { create } from "@storybook/theming";
import * as tokens from '../src/token/storybook/tokens';

export const light = create({
  base: "light",

  colorPrimary: tokens.KsColorPrimaryBase,
  colorSecondary: tokens.KsColorPrimaryBase,

  // UI
  appBg: tokens.KsColorPrimaryToBg9Base,
  appContentBg: tokens.KsBackgroundColorDefaultBase,
  appBorderColor: tokens.KsColorPrimaryAlpha2Base,
  appBorderRadius: tokens.KsBorderRadiusCard,

  // Typography
  fontBase: tokens.KsFontFamilyInterface,
  fontCode: tokens.KsFontFamilyMono,

  // Text colors
  textColor: tokens.KsTextColorDefaultBase,
  textInverseColor: tokens.KsTextColorDefaultInvertedBase,

  // Toolbar default and active colors
  barTextColor: tokens.KsColorPrimaryAlpha6Base,
  barSelectedColor: tokens.KsColorPrimaryBase,
  barBg: tokens.KsBackgroundColorDefaultBase,

  // Form colors
  inputBg: tokens.KsBackgroundColorInterfaceInteractiveBase,
  inputBorder: tokens.KsColorFgToBg7Base,
  inputTextColor: tokens.KsTextColorInterfaceInteractiveBase,
  inputBorderRadius: tokens.KsBorderRadiusControl,

  brandTitle: "Your kickstartDS Storybook",
  brandUrl: "https://www.kickstartDS.com",
  brandImage: "/logo.svg",
});
```
</CH.Code>

We [import the `create` function](focus://1) from **Storybook** [and our token](focus://2). With those we create a new theme, [with `light` as the `base`](focus://5). We won't go into detail about[ the specific token applications](focus://7:33) now, but feel free to adjust [`brandTitle` and `brandUrl`](focus://35:36) to your liking! [`brandImage`](focus://37) will be added next...
</CH.Section>

Create a folder `static` on your project root now:

```bash
mkdir -p static
```

For this to work, we add our logo to the `static/` directory created before, as `logo.svg`. If you don't have a fitting logo laying around now, feel free to [just use ours (right click > save as)](https://www.kickstartds.com/logo.svg).

#### Adding `.storybook/manager.js`

Now create the second file needed, `.storybook/manager.js`...

```bash
touch .storybook/manager.js
```

... and add this code to it:

<CH.Section>
<CH.Code>
```js .storybook/manager.js
import { addons } from "@storybook/addons";
import { light } from "./themes";

addons.setConfig({ theme: light });
```
</CH.Code>

We import [`addons` from **Storybook**](focus://1), and [our newly created theme](focus://2) from `.storybook/themes.js`. We combine those to [apply our theme to **Storybook**](focus://4).
</CH.Section>

#### Add a fitting `favicon`

Our final addition for this section includes changing `.storybook/manager-head.html` again. Add the following lines to it:

<CH.Section>
<CH.Code>
```html .storybook/manager-head.html focus=2:8
<link rel="stylesheet" href="manager.css" />
<link rel="shortcut icon" href="/favicon/favicon.ico" />
<link
  rel="icon"
  type="image/png"
  href="/favicon/favicon-192-192.png"
  sizes="192x192"
/>
```
</CH.Code>

This adds a good looking, custom `favicon` to our **Storybook** when opened in the browser, which really helps to find your own **Design System**... in a sea of tabs ðŸ˜….<br/>
The configuration expects the files [`favicon/favicon.ico`](focus://2[27:53]) and [`favicon/favicon-192-192.png`](focus://6[3:37]) to be placed in our `static/` folder, like it was the case for `logo.svg` before.
</CH.Section>

Create the sub directory...

```bash
mkdir -p static/favicon
```

... and place your files inside. If you need something to continue, feel free to use our [`favicon.ico` (right click > save as)](https://www.kickstartDS.com/favicon/favicon.ico) and [`favicon-192-192.png` (right click > save as)](https://www.kickstartDS.com/favicon/favicon-192-192.png) for now!

#### Finalizing **Storybook** theming

If you start your **Storybook** now (`yarn storybook`), you should feel right at home! You should see your own logo, your own colors and your font being applied to **Storybook** itself (or the ones you've used while testing around). Giving it your own, unique flavour... without being distracting!

As we've added one new generated file, we make sure to include it in our `.gitignore`:

```bash .gitignore focus=10
# Node
node_modules

# Storybook
storybook-static

# kickstartDS
src/token/tokens.css
src/token/storybook/tokens.css
src/token/storybook/tokens.js
src/token/storybook/icons.svg
static/manager.css
static/manager.css.map
```

### Integrate with **kickstartDS**

What follows is in preparation for the next big chapter, [adding components](./components.mdx). It will have no immediately visible effect now, next to a small test component that we'll add to the *Welcome* page, but ensures a smoother experience going forward... without having to return to general setup tasks all the time.

Integration consists mainly of adding glue code and snippets to the **Storybook** configuration, to tell it about the existence of **kickstartDS**. How code should be handled, where `CSS` is located, and how our **Icons** work!

#### Transpile `@kickstartDS` components

Base components installed as part of `@kickstartDS` dependencies (e.g. `@kickstartDS/base`) are placed in your `node_modules` after installation. For those components to be compatible with **Storybook**, and its build &amp; compilation pipeline, we need to ensure that they get transpiled (like your [local code automatically is](https://storybook.js.org/docs/react/builders/webpack)). Add the following `webpackFinal` configuration to `.storybook/main.js`:

<CH.Section>
<CH.Code>
```js .storybook/main.js focus=1,23:51
const path = require("path");

module.exports = {
  stories: [
    "../src/**/*.stories.mdx",
    "../src/**/*.stories.@(js|jsx|ts|tsx)",
    "../docs/**/*.stories.mdx",
  ],
  addons: [
    "@storybook/addon-links",
    "@storybook/addon-essentials",
    "@storybook/addon-interactions",
    {
      name: "storybook-design-token",
      options: { designTokenGlob: "src/token/storybook/*" },
    },
  ],
  framework: "@storybook/react",
  staticDirs: ["../static"],
  features: {
    postcss: false,
  },
  async webpackFinal(config, { configType }) {
    const babelRuleIndex = config.module.rules.findIndex((rule) =>
      rule?.use?.some((u) => u?.loader.includes("babel-loader"))
    );

    config.module.rules[babelRuleIndex].exclude =
      /node_modules\/(?!(@kickstartds\/))/;

    config.module.rules.push({
      test: /\.scss$/,
      use: [
        "style-loader",
        "css-loader",
        {
          loader: "sass-loader",
          options: {
            sassOptions: {
              includePaths: [path.resolve(__dirname, "../node_modules")],
            },
          },
        },
      ],
      include: path.resolve(__dirname, "../src"),
    });

    config.resolve.mainFields = ["browser", "module", "main"];

    return config;
  },
}
```
</CH.Code>

This sets up everything needed to import components from `@kickstartDS` (e.g. `import { Button } from "@kickstartds/base/lib/button"`). First we [add exemptions to the `babel-loader`](focus://24:29) for JavaScript code transpilation, which normally ignores code in `node_modules`. Additionally we add [loaders for **CSS** / **SCSS**](focus://31:46), [allow includes from `node_modules`](focus://39:41), configure [the path our code lives in](focus://45), and [configure `mainFields`](focus://48) ([learn about them here](config.resolve.mainFields)).

Read more [about **Storybook**s **Webpack** builder](https://storybook.js.org/docs/react/builders/webpack), or [**Webpack** in general](https://webpack.js.org/), for details.
</CH.Section>

#### Adding a demo `Button`

To test our **Storybook** setup and integration actually works, we add a `Button` to our *Welcome* page.

<CH.Section>
<CH.Code>
```mdx docs/welcome.stories.mdx focus=2,18
import { Meta } from "@storybook/addon-docs";
import { Button } from "@kickstartds/base/lib/button";

<Meta title="Welcome" />

# Your kickstartDS based Design System

Ipsum voluptate reprehenderit ut aliquid laborum enim. Optio et suscipit aliquam voluptate nostrum est. Corrupti ab laboriosam qui aut aliquid iusto nobis voluptatum. Perferendis non reiciendis illum. Vel et sint est.

Alias placeat accusantium voluptatem pariatur dolor et. Dicta quia officia voluptatem quia nulla natus. Accusantium in voluptate porro. Libero voluptatem placeat ipsum dolores deserunt omnis odio.

Sed distinctio consequuntur et et aliquid. Exercitationem autem impedit expedita. Beatae eum voluptatem eaque necessitatibus repellendus. Velit qui est optio. Ut est voluptates incidunt et qui sed dolorem. Quidem molestiae velit non laudantium consequatur autem.

Amet doloremque voluptas suscipit. Omnis incidunt sit nesciunt voluptate sed voluptatem delectus quis. Repudiandae occaecati magni fugit. Minus sunt quia ab temporibus. Voluptatibus vel odit facere enim et.

Consequatur et consequuntur et. Nam consequatur sed voluptas ea. Tempore vero velit et hic. Ut et aspernatur quaerat ut aut consequatur. Quisquam aliquid ea adipisci nulla quia ut dolor. Accusamus earum quasi quaerat.

<Button label="Learn more"/>
```
</CH.Code>

First we [import the `Button` component](focus://2) from `@kickstartds/base/lib/button`, to then [add it to the end of the page](focus://18) with a `label` of "Learn more". To see all available options for such a `Button` component [have a look at our **Storybook**](https://www.kickstartds.com/storybook/?path=/story/base-button--solid).

If not still running, start your **Storybook** again now (`yarn storybook`), and browse to the *Welcome* page. You should be greeted by your newly added `Button` there. But there's something missing. It's not looking quite right, yet!
</CH.Section>

#### Add missing styles in `preview.js`

<CH.Section>
We need [some base styles and JavaScript](focus://1:2) provided by `@kickstartds/base`, and [our own **Design Token** set](focus://4), the one converted to **CSS custom properties** in `src/token/tokens.css`.

Add the following lines to your `.storybook/preview.js`:

<CH.Code>
```js .storybook/preview.js focus=1:4
import "@kickstartds/base/lib/global/base.js";
import "@kickstartds/base/lib/global/base.css";

import "../src/token/tokens.css";

export const parameters = {
  actions: { argTypesRegex: "^on[A-Z].*" },
  controls: {
    matchers: {
      color: /(background|color)$/i,
      date: /Date$/,
    },
  },
  options: {
    storySort(a, b) {
      // welcome page to top!
      if (a[0].includes("welcome")) {
        return -1;
      }

      // alphabetically
      return a[1].kind === b[1].kind
        ? 0
        : a[1].id.localeCompare(b[1].id, undefined, { numeric: true });
    },
  },
  designToken: {
    disable: true,
  },
}
```
</CH.Code>
</CH.Section>

Re-start **Storybook** to revisit the *Welcome* page. Everything should be looking as expected now!

#### Adding an `Icon` to our `Button`

As a small motivation for the next section, change the `Button` markup in `docs/welcome.stories.jsx` slightly:

<CH.Section>
<CH.Code>
```mdx docs/welcome.stories.jsx focus=18
import { Meta } from "@storybook/addon-docs";
import { Button } from "@kickstartds/base/lib/button";

<Meta title="Welcome" />

# Your kickstartDS based Design System

Ipsum voluptate reprehenderit ut aliquid laborum enim. Optio et suscipit aliquam voluptate nostrum est. Corrupti ab laboriosam qui aut aliquid iusto nobis voluptatum. Perferendis non reiciendis illum. Vel et sint est.

Alias placeat accusantium voluptatem pariatur dolor et. Dicta quia officia voluptatem quia nulla natus. Accusantium in voluptate porro. Libero voluptatem placeat ipsum dolores deserunt omnis odio.

Sed distinctio consequuntur et et aliquid. Exercitationem autem impedit expedita. Beatae eum voluptatem eaque necessitatibus repellendus. Velit qui est optio. Ut est voluptates incidunt et qui sed dolorem. Quidem molestiae velit non laudantium consequatur autem.

Amet doloremque voluptas suscipit. Omnis incidunt sit nesciunt voluptate sed voluptatem delectus quis. Repudiandae occaecati magni fugit. Minus sunt quia ab temporibus. Voluptatibus vel odit facere enim et.

Consequatur et consequuntur et. Nam consequatur sed voluptas ea. Tempore vero velit et hic. Ut et aspernatur quaerat ut aut consequatur. Quisquam aliquid ea adipisci nulla quia ut dolor. Accusamus earum quasi quaerat.

<Button iconAfter={{ icon: 'chevron-right' }} label="Learn more"/>
```
</CH.Code>

We [add an `Icon` to the button](focus://18[9:45]) using `iconAfter` (you can use `iconAfter` or `iconBefore`, or both!). To see a list of available `Icon`s you can have a look at your `Storybook`. It should have a page titled **Icons** in the **Design Tokens** category. This has all of your `.svg` icons compiled, all those are possible inputs for `icon` here.
</CH.Section>

To see all options available on a `Button`, have a look at its documentation in `Storybook` (either [in our docs](https://www.kickstartds.com/storybook/?path=/docs/base-button--solid), or locally through the composed docs in your sidebar).

If you re-check your *Welcome* page in the browser again now, you'll see the button having space reserved for an `Icon`. But the `Icon` itself is still missing. This is because we haven't included our **Icon Sprite** for component previews in **Storybook**, yet. The only reason they're successfully displayed on your **Icons** page currently, is that the `storybook-design-token` addon is picking them up using its own loader.

Let's add our **Icon Sprite** to **Storybook** for real, now!

#### Integrate `Icons` with **Storybook** previews

Instead of loading a bunch of single files per icon, we encourage compiling all your `SVG`s into one sprite. We offer different output formats for that through the pre-configured **Style Dictionary** in use (SVG, HTML, React). This can be included once in the page, and the elements will just be referenced. Learn more about sprites with [`<symbol>` and `<use>` on MDN](https://developer.mozilla.org/en-US/docs/Web/SVG/Element/symbol).

As with other changes that had to do with how **Storybook** renders our own components (in a preview context), we will need to adjust `.storybook/preview.js` again to integrate **kickstartDS** and **Storybook**:

<CH.Section>
<CH.Code>
```js .storybook/preview.js focus=1,6,34:41,44:51
import { DocsContainer } from "@storybook/addon-docs";

import "@kickstartds/base/lib/global/base.js";
import "@kickstartds/base/lib/global/base.css";

import IconSprite from "../src/token/icons/IconSprite";

import "../src/token/tokens.css";

export const parameters = {
  actions: { argTypesRegex: "^on[A-Z].*" },
  controls: {
    matchers: {
      color: /(background|color)$/i,
      date: /Date$/,
    },
  },
  options: {
    storySort(a, b) {
      // welcome page to top!
      if (a[0].includes("welcome")) {
        return -1;
      }

      // alphabetically
      return a[1].kind === b[1].kind
        ? 0
        : a[1].id.localeCompare(b[1].id, undefined, { numeric: true });
    },
  },
  designToken: {
    disable: true,
  },
  docs: {
    container: (props) => (
      <>
        <IconSprite />
        <DocsContainer {...props} />
      </>
    ),
  },
};

export const decorators = [
  (Story) => (
    <>
      <IconSprite />
      <Story />
    </>
  ),
];
```
</CH.Code>

We wrap **Storybook**s story rendering in two places. Firstly we [import the default `DocsContainer`](focus://1) from `@storybook/addon-docs` [and our **Icons**](focus://6) from `../src/token/icons/IconSprite`, to then [ensure that every time a docs page is rendered](focus://34:41), our **Icons** [get included there](focus://37), too. Secondly we [add our first decorator](focus://44:51) to the `decorators` array, also [adding our imported **Icons**](focus://47). This one is concerned with all the other story previews there are, read [more about decorators here](https://storybook.js.org/docs/react/writing-stories/decorators).
</CH.Section>

You might have stumbled over our **Icons** import above: `import IconSprite from "../src/token/icons/IconSprite"`. That file doesn't actually exist (yet)! You might also recall how we've added annotated **Design Token** before, by adding a new transform to our **Style Dictionary** configuration. We'll now add another transform to it that takes our **Icons** and converts them to a `JSX` component-variant of our `IconSprite`, ready to be imported in `.storybook/preview.js`:

<CH.Section>
<CH.Code>
```js sd.config.cjs focus=14:16
const path = require('path');
const StyleDictionary = require("style-dictionary");
const { config } = require("@kickstartds/style-dictionary");

module.exports = StyleDictionary.extend(config).extend({
  source: [
    "src/token/dictionary/**/*.json",
    path.join(path.dirname(require.resolve('@kickstartds/core/package.json')), 'source/design-tokens/icons/*.svg')
  ],
  platforms: {
    css: {
      buildPath: 'src/token/'
    },
    jsx: {
      buildPath: 'src/token/icons/'
    },
    storybook: {
      buildPath: 'src/token/storybook/'
    },
    js: {
      transforms: ["attribute/cti", "name/cti/pascal", "size/rem", "color/css"],
      buildPath: "src/token/storybook/",
      files: [
        {
          destination: "tokens.js",
          format: "javascript/es6",
        },
      ],
    },
  },
});

```
</CH.Code>
</CH.Section>

And, you know the drill by now, after changing our `sd.config.cjs` we'll want to re-compile our **Style Dictionary**...

```bash
yarn build-tokens
```

... to find a new output for `jsx` in the log, written to `src/token/icons/IconSprite.js`, as referenced by `.storybook/preview.js`:

```shellscript focus=37:38
yarn run v1.22.18
$ kickstartDS tokens compile
  _    _      _        _             _   ____  ____
 | | _(_) ___| | _____| |_ __ _ _ __| |_|  _ \/ ___|
 | |/ / |/ __| |/ / __| __/ _` | '__| __| | | \___ \
 |   <| | (__|   <\__ \ || (_| | |  | |_| |_| |___) |
 |_|\_\_|\___|_|\_\___/\__\__,_|_|   \__|____/|____/

______________/\\\\\\\\\__/\\\______________/\\\\\\\\\\\_______
 ___________/\\\////////__\/\\\_____________\/////\\\///________
  _________/\\\/___________\/\\\_________________\/\\\___________
   ________/\\\_____________\/\\\_________________\/\\\___________
    _______\/\\\_____________\/\\\_________________\/\\\___________
     _______\//\\\____________\/\\\_________________\/\\\___________
      ________\///\\\__________\/\\\_________________\/\\\___________
       __/\\\____\////\\\\\\\\\_\/\\\\\\\\\\\\\\\__/\\\\\\\\\\\__/\\\_
        _\///________\/////////__\///////////////__\///////////__\///__

Version: 1.0.0
For more information visit:
https://www.kickstartDS.com/docs/intro/cli

Starting...
[kickstartDS: general] [info]: welcome to the kickstartDS CLI
[kickstartDS: tokens/compile] starting: compile command with compile variable compile-task
[1/1] [compile: check] [info]: checking prerequesites before starting
[1/1] [compile: check] [info]: prerequesites met, starting
[compile: cleanup] [info]: cleaning up temp dir /tmp/tokens-compile-compile-task before starting command
[compile: cleanup] [info]: finished cleaning up temp dir /tmp/tokens-compile-compile-task before starting command
[1/1] [compile: compile] [info]: running the compile subtask
[1/1] [compile: compile] [info]: getting Style Dictionary from token files
[1/1] [compile: compile] [info]: compiling Style Dictionary to needed CSS and assets

css
âœ”ï¸Ž src/token/tokens.css

jsx
âœ”ï¸Ž src/token/icons/IconSprite.js

storybook
âœ”ï¸Ž src/token/storybook/tokens.css
âœ”ï¸Ž src/token/storybook/icons.svg

js
âœ”ï¸Ž src/token/storybook/tokens.js
[1/1] [compile: compile] [info]: copying generated CSS and assets to local folder
[1/1] [compile: compile] [info]: finished running the compile subtask successfully
[kickstartDS: tokens/compile] finished: compile command with compile variable compile-task
Done in 1.49s.
```

(Re-)open your **Storybook** now and change to the *Welcome* page. You should be greeted by a `Button` with its `Icon` visible, as configured in the component props!

Like before, we make sure to include the newly generated file in our `.gitignore`:

```bash .gitignore focus=9
# Node
node_modules

# Storybook
storybook-static

# kickstartDS
src/token/tokens.css
src/token/icons/IconSprite.js
src/token/storybook/tokens.css
src/token/storybook/tokens.js
src/token/storybook/icons.svg
static/manager.css
static/manager.css.map
```

#### Integrate **kickstartDS** `radio` with **Storybook** actions

We use a small, light-weight communication component called `radio` (basically a mini [PubSub](https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern)) in all existing components for communication and event handling. It's part of our **Core** (`@kickstartDS/core`) architecture. To make debugging easier and more transparent, we connect our `radio` with **Storybook**s actions, and their actions addon.

Configuration is pretty easy, just add the following lines to `.storybook/preview.js`:

```js .storybook/preview.js focus=1,11:12
import { actions } from "@storybook/addon-actions";
import { DocsContainer } from "@storybook/addon-docs";

import "@kickstartds/base/lib/global/base.js";
import "@kickstartds/base/lib/global/base.css";

import IconSprite from "../src/token/icons/IconSprite";

import "../src/token/tokens.css";

const myActions = actions("radio");
window._ks.radio.on("*", myActions.radio);

export const parameters = {
  actions: { argTypesRegex: "^on[A-Z].*" },
  controls: {
    matchers: {
      color: /(background|color)$/i,
      date: /Date$/,
    },
  },
  options: {
    storySort(a, b) {
      // welcome page to top!
      if (a[0].includes("welcome")) {
        return -1;
      }

      // alphabetically
      return a[1].kind === b[1].kind
        ? 0
        : a[1].id.localeCompare(b[1].id, undefined, { numeric: true });
    },
  },
  designToken: {
    disable: true,
  },
  docs: {
    container: (props) => (
      <>
        <IconSprite />
        <DocsContainer {...props} />
      </>
    ),
  },
};

export const decorators = [
  (Story) => (
    <>
      <IconSprite />
      <Story />
    </>
  ),
];
```

Now everytime a **kickstartDS** component emits an event over `radio`, it will be displayed in the **Actions** tab in **Storybook**.

### Install remaining addons

Like the last step, this one will also mostly be done in preparation. We add some more addons, that each add a specific view of your components to **Storybook**:

* **HTML** rendering addon
* **JSON Schema** addon
* **Component Token** addon

This will give you a great overview of all aspects that make up a component in a Design System in general, and with **kickstartDS** specifically. Especially helpful while adding components in the [next main chapter of this guide](./components.mdx)!

First add the addons to your project:

```bash
yarn add -D @kickstartds/storybook-addon-component-tokens @kickstartds/storybook-addon-jsonschema @whitespace/storybook-addon-html@git+https://github.com/lmestel/storybook-addon-html.git
```

<Admonition type="tip" title="Fork of @whitespace/storybook-addon-html">
  We currently need a fork of `@whitespace/storybook-addon-html`, because the original version of the addon just takes the `HTML` from the browser. This is problematic, because it means that markup might already be manipulated by client-side **JavaScript** (e.g. some classes being added). For our use, copy &amp; paste of the initial `HTML`, [we've switched the addon to use **React**s SSR Renderer](https://github.com/lmestel/storybook-addon-html/commit/caf235ee36d4c3cab769b83475f3fb00b56e2c40).
</Admonition>

To activate those addons, we need to add them to `.storybook/main.js`, too. They don't need any further configuration:

```js .storybook/main.js focus=17:19
const path = require("path");

module.exports = {
  stories: [
    "../src/**/*.stories.mdx",
    "../src/**/*.stories.@(js|jsx|ts|tsx)",
    "../docs/**/*.stories.mdx",
  ],
  addons: [
    "@storybook/addon-links",
    "@storybook/addon-essentials",
    "@storybook/addon-interactions",
    {
      name: "storybook-design-token",
      options: { designTokenGlob: "src/token/storybook/*" },
    },
    "@whitespace/storybook-addon-html",
    "@kickstartds/storybook-addon-component-tokens",
    "@kickstartds/storybook-addon-jsonschema",
  ],
  framework: "@storybook/react",
  staticDirs: ["../static"],
  features: {
    postcss: false,
  },
  async webpackFinal(config, { configType }) {
    const babelRuleIndex = config.module.rules.findIndex((rule) =>
      rule?.use?.some((u) => u?.loader.includes("babel-loader"))
    );

    config.module.rules[babelRuleIndex].exclude =
      /node_modules\/(?!(@kickstartds\/))|core-js/;

    config.module.rules.push({
      test: /\.scss$/,
      use: [
        "style-loader",
        "css-loader",
        {
          loader: "sass-loader",
          options: {
            sassOptions: {
              includePaths: [path.resolve(__dirname, "../node_modules")],
            },
          },
        },
      ],
      include: path.resolve(__dirname, "../src"),
    });

    config.resolve.mainFields = ["browser", "module", "main"];

    return config;
  },
}
```

<Admonition type="tip" title="Fork of @whitespace/storybook-addon-html">
  We deactivate `@kickstartds/storybook-addon-jsonschema` for now, because there's a bug that needs to be fixed to make it compatible with the Open Source `2.0.0` release of **kickstartDS**. You can follow the progress for this on the following ticket: [kickstartDS/storybook-addon-jsonschema/issues/19](https://github.com/kickstartDS/storybook-addon-jsonschema/issues/19)
</Admonition>

## Review changes

Let us review our `package.json` again now, it's starting to grow already:

<CH.Spotlight>
<CH.Code>
```json package.json
{
  "name": "@my/design-system",
  "version": "1.0.0",
  "description": "Design System for all @MY needs",
  "main": "dist/index.js",
  "scripts": {
    "build-storybook": "build-storybook",
    "build-tokens": "kickstartDS tokens compile",
    "init-tokens": "kickstartDS tokens init",
    "sass-manager": "sass --load-path=node_modules .storybook/manager.scss static/manager.css",
    "storybook": "start-storybook -p 6006",
    "test": "echo \"Error: no test specified\" && exit 1",
    "watch:sass-manager": "yarn sass-manager --watch"
  },
  "author": "Jonas Ulrich",
  "license": "MIT",
  "dependencies": {
    "@kickstartds/base": "^2.0.2",
    "kickstartds": "^1.0.0",
    "react": "^17.0.2",
    "react-dom": "^17.0.2"
  },
  "devDependencies": {
    "@babel/core": "^7.19.3",
    "@kickstartds/storybook-addon-component-tokens": "^0.1.6",
    "@kickstartds/storybook-addon-jsonschema": "^1.0.5",
    "@storybook/addon-actions": "^6.5.12",
    "@storybook/addon-essentials": "^6.5.12",
    "@storybook/addon-interactions": "^6.5.12",
    "@storybook/addon-links": "^6.5.12",
    "@storybook/builder-webpack4": "^6.5.12",
    "@storybook/manager-webpack4": "^6.5.12",
    "@storybook/react": "^6.5.12",
    "@storybook/testing-library": "^0.0.13",
    "@whitespace/storybook-addon-html": "git+https://github.com/lmestel/storybook-addon-html.git",
    "babel-loader": "^8.2.5",
    "sass": "^1.56.0",
    "storybook-design-token": "^2.8.0"
  }
}
````

</CH.Code>

---

### **HTML** rendering addon

We use [`@whitespace/storybook-addon-html`](https://storybook.js.org/addons/@whitespace/storybook-addon-html) to add a tab to every component Canvas sidebar, where you can copy the currently configured component as a plain HTML component.

<CH.Code>
```json package.json focus=35
{
  "name": "@my/design-system",
  "version": "1.0.0",
  "description": "Design System for all @MY needs",
  "main": "dist/index.js",
  "scripts": {
    "build-storybook": "build-storybook",
    "build-tokens": "kickstartDS tokens compile",
    "init-tokens": "kickstartDS tokens init",
    "sass-manager": "sass --load-path=node_modules .storybook/manager.scss static/manager.css",
    "storybook": "start-storybook -p 6006",
    "test": "echo \"Error: no test specified\" && exit 1",
    "watch:sass-manager": "yarn sass-manager --watch"
  },
  "author": "Jonas Ulrich",
  "license": "MIT",
  "dependencies": {
    "@kickstartds/base": "^2.0.2",
    "kickstartds": "^1.0.0",
    "react": "^17.0.2",
    "react-dom": "^17.0.2"
  },
  "devDependencies": {
    "@babel/core": "^7.19.3",
    "@kickstartds/storybook-addon-component-tokens": "^0.1.6",
    "@kickstartds/storybook-addon-jsonschema": "^1.0.5",
    "@storybook/addon-actions": "^6.5.12",
    "@storybook/addon-essentials": "^6.5.12",
    "@storybook/addon-interactions": "^6.5.12",
    "@storybook/addon-links": "^6.5.12",
    "@storybook/builder-webpack4": "^6.5.12",
    "@storybook/manager-webpack4": "^6.5.12",
    "@storybook/react": "^6.5.12",
    "@storybook/testing-library": "^0.0.13",
    "@whitespace/storybook-addon-html": "git+https://github.com/lmestel/storybook-addon-html.git",
    "babel-loader": "^8.2.5",
    "sass": "^1.56.0",
    "storybook-design-token": "^2.8.0"
  }
}

````

</CH.Code>

---

### **Design Token** addon

For **Design Token** documentation we use [`storybook-design-token`](https://storybook.js.org/addons/storybook-design-token/). Mainly for its `DesignTokenDocBlock` component, which helps rendering the pages we'll create to display our **Design Token** set.

<CH.Code>
```json package.json focus=38
{
  "name": "@my/design-system",
  "version": "1.0.0",
  "description": "Design System for all @MY needs",
  "main": "dist/index.js",
  "scripts": {
    "build-storybook": "build-storybook",
    "build-tokens": "kickstartDS tokens compile",
    "init-tokens": "kickstartDS tokens init",
    "sass-manager": "sass --load-path=node_modules .storybook/manager.scss static/manager.css",
    "storybook": "start-storybook -p 6006",
    "test": "echo \"Error: no test specified\" && exit 1",
    "watch:sass-manager": "yarn sass-manager --watch"
  },
  "author": "Jonas Ulrich",
  "license": "MIT",
  "dependencies": {
    "@kickstartds/base": "^2.0.2",
    "kickstartds": "^1.0.0",
    "react": "^17.0.2",
    "react-dom": "^17.0.2"
  },
  "devDependencies": {
    "@babel/core": "^7.19.3",
    "@kickstartds/storybook-addon-component-tokens": "^0.1.6",
    "@kickstartds/storybook-addon-jsonschema": "^1.0.5",
    "@storybook/addon-actions": "^6.5.12",
    "@storybook/addon-essentials": "^6.5.12",
    "@storybook/addon-interactions": "^6.5.12",
    "@storybook/addon-links": "^6.5.12",
    "@storybook/builder-webpack4": "^6.5.12",
    "@storybook/manager-webpack4": "^6.5.12",
    "@storybook/react": "^6.5.12",
    "@storybook/testing-library": "^0.0.13",
    "@whitespace/storybook-addon-html": "git+https://github.com/lmestel/storybook-addon-html.git",
    "babel-loader": "^8.2.5",
    "sass": "^1.56.0",
    "storybook-design-token": "^2.8.0"
  }
}
````

</CH.Code>

---

### **JSON Schema** addon

We use our own [`@kickstartds/storybook-addon-jsonschema`](https://storybook.js.org/addons/@kickstartds/storybook-addon-jsonschema) to display our component structure / API in a Canvas tab, alongside the component.

Read more about it on our [dedicated integration page](../../integration/storybook/schema.mdx).

<CH.Code>
```json package.json focus=26
{
  "name": "@my/design-system",
  "version": "1.0.0",
  "description": "Design System for all @MY needs",
  "main": "dist/index.js",
  "scripts": {
    "build-storybook": "build-storybook",
    "build-tokens": "kickstartDS tokens compile",
    "init-tokens": "kickstartDS tokens init",
    "sass-manager": "sass --load-path=node_modules .storybook/manager.scss static/manager.css",
    "storybook": "start-storybook -p 6006",
    "test": "echo \"Error: no test specified\" && exit 1",
    "watch:sass-manager": "yarn sass-manager --watch"
  },
  "author": "Jonas Ulrich",
  "license": "MIT",
  "dependencies": {
    "@kickstartds/base": "^2.0.2",
    "kickstartds": "^1.0.0",
    "react": "^17.0.2",
    "react-dom": "^17.0.2"
  },
  "devDependencies": {
    "@babel/core": "^7.19.3",
    "@kickstartds/storybook-addon-component-tokens": "^0.1.6",
    "@kickstartds/storybook-addon-jsonschema": "^1.0.5",
    "@storybook/addon-actions": "^6.5.12",
    "@storybook/addon-essentials": "^6.5.12",
    "@storybook/addon-interactions": "^6.5.12",
    "@storybook/addon-links": "^6.5.12",
    "@storybook/builder-webpack4": "^6.5.12",
    "@storybook/manager-webpack4": "^6.5.12",
    "@storybook/react": "^6.5.12",
    "@storybook/testing-library": "^0.0.13",
    "@whitespace/storybook-addon-html": "git+https://github.com/lmestel/storybook-addon-html.git",
    "babel-loader": "^8.2.5",
    "sass": "^1.56.0",
    "storybook-design-token": "^2.8.0"
  }
}
````

</CH.Code>

---

### **Component Token** addon

For this we use another Canvas and tab based addon we've written ourselves, to visualize your Component Token: [`@kickstartds/storybook-addon-component-token`](https://storybook.js.org/addons/@kickstartds/storybook-addon-component-tokens/). Especially helps discovering the token layering applied to a component.

Read more about it on our [dedicated integration page](../../integration/storybook/token.mdx).

<CH.Code>
```json package.json focus=25
{
  "name": "@my/design-system",
  "version": "1.0.0",
  "description": "Design System for all @MY needs",
  "main": "dist/index.js",
  "scripts": {
    "build-storybook": "build-storybook",
    "build-tokens": "kickstartDS tokens compile",
    "init-tokens": "kickstartDS tokens init",
    "sass-manager": "sass --load-path=node_modules .storybook/manager.scss static/manager.css",
    "storybook": "start-storybook -p 6006",
    "test": "echo \"Error: no test specified\" && exit 1",
    "watch:sass-manager": "yarn sass-manager --watch"
  },
  "author": "Jonas Ulrich",
  "license": "MIT",
  "dependencies": {
    "@kickstartds/base": "^2.0.2",
    "kickstartds": "^1.0.0",
    "react": "^17.0.2",
    "react-dom": "^17.0.2"
  },
  "devDependencies": {
    "@babel/core": "^7.19.3",
    "@kickstartds/storybook-addon-component-tokens": "^0.1.6",
    "@kickstartds/storybook-addon-jsonschema": "^1.0.5",
    "@storybook/addon-actions": "^6.5.12",
    "@storybook/addon-essentials": "^6.5.12",
    "@storybook/addon-interactions": "^6.5.12",
    "@storybook/addon-links": "^6.5.12",
    "@storybook/builder-webpack4": "^6.5.12",
    "@storybook/manager-webpack4": "^6.5.12",
    "@storybook/react": "^6.5.12",
    "@storybook/testing-library": "^0.0.13",
    "@whitespace/storybook-addon-html": "git+https://github.com/lmestel/storybook-addon-html.git",
    "babel-loader": "^8.2.5",
    "sass": "^1.56.0",
    "storybook-design-token": "^2.8.0"
  }
}
```

</CH.Code>
</CH.Spotlight>

## Result

With that, we've successfully added **Storybook** to our Design System, integrated it with our **Design Token** / **Style Dictionary**, adopted some concepts of **kickstartDS**, and even added a bit of theming! We have our main setup running now, including **Storybook**.

## Next Step

It's time to get to the exciting part... adding components to our Design System. To learn about the different ways you can go about in that, follow our next section!

## Code Sandbox

See the result of this step in the **Code Sandbox** below. It's showing specifically the result after this step. You can also view this on **Github** directly in [the `ds-guide` repository](https://github.com/kickstartDS/ds-guide), there's a branch for every step... and we're currently on [the branch `step/3`](https://github.com/kickstartDS/ds-guide/tree/step/3) in the guide:

<iframe
  src="https://codesandbox.io/embed/github/kickstartDS/ds-guide/tree/step%2F3/?fontsize=14&hidenavigation=1&module=%2Fpackage.json&theme=dark&view=editor"
  style={{
    width: '100%',
    height: '500px',
    border: 0,
    borderRadius: '4px',
    overflow: 'hidden',
  }}
  title="ds-guide"
  allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"
  sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"
></iframe>

Toggle the file browser with the hamburger icon at the top left, [or open it directly in your browser](https://codesandbox.io/s/github/kickstartDS/ds-guide/tree/step/3?file=/package.json).
