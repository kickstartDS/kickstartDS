@use 'sass:meta';
@use 'sass:map';
@use './breakpoint';

@mixin responsive-custom-property($name, $value) {
  @if meta.type-of($value) == 'map' {
    @each $bp, $val in $value {
      @if $bp == 'xs' or not $bp {
        @include responsive-custom-property($name, $val);
      } @else {
        @include breakpoint.media('â‰¥#{$bp}') {
          @include responsive-custom-property($name, $val);
        }
      }
    }
  } @else if $value {
    #{$name}: #{$value};
  }
}

@mixin styles($map) {
  @if not map.has-key($map, 'name-') {
    @error '`name-`-property is requred.';
  }
  $name: map.get($map, 'name-');
  $map: map.remove($map, 'name-');

  @each $key, $rules in $map {
    $group: if($key == 'host', null, '_#{$key}');
    $prefix: '--#{$name + $group}--';

    @each $selector, $properties in $rules {
      #{$selector} {
        @each $property, $value in $properties {
          @include responsive-custom-property($prefix + $property, $value);
        }
      }
    }
  }
}
